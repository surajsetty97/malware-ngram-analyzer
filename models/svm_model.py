import sys
import pandas as pd 
from sklearn.svm import SVC
from sklearn.model_selection import train_test_split

def main(args):
    START_N_GRAM_SIZE = int(args[1])
    benign_file = ''
    malware_file = ''
    MAX_NGRAM = 7
    for i in range(START_N_GRAM_SIZE, MAX_NGRAM+1):
        try:
            benign_file = 'n-gram-files\\benign_' + str(i) + 'gram.csv'
            malware_file = 'n-gram-files\\malware_' + str(i) + 'gram.csv'
        except Exception as e:
            print(e)
            sys.exit()
        
        benign_df = pd.read_csv(benign_file, header=None)
        malware_df = pd.read_csv(malware_file, header=None)

        X = benign_df.iloc[:,:]
        y = [0] * X.shape[0]
        X2 = malware_df.iloc[:,:]
        y2 = [1] * X2.shape[0]

        X = X.append(X2).values
        y+=y2

        X_train, X_test, y_train, y_test = train_test_split(X, y, test_size = 0.15, random_state = 0)


        clf = SVC(kernel='linear')
        clf.fit(X_train, y_train)
        print('Score with {}-gram: {}'.format(i, clf.score(X_test, y_test)))







if __name__ == "__main__":
    main(sys.argv)